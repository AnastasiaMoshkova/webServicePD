{% extends "base.html" %}
{% block title %}–î–≤–∏–≥–∞—Ç–µ–ª—å–Ω–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Ä—É–∫{% endblock %}

{% block content %}
<button id="backBtn" class="back-btn">‚Üê –ù–∞–∑–∞–¥</button>

<div id="mainMenu" class="menu">
    <button data-section="record-select">üìπ –ó–∞–ø–∏—Å—å / –ó–∞–≥—Ä—É–∑–∫–∞</button>
    <button data-section="process">‚öôÔ∏è –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö</button>
    <button data-section="signals">üìà –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ —Å–∏–≥–Ω–∞–ª–æ–≤</button>
</div>

<!-- ‚úÖ –û–ë–™–ï–î–ò–ù–ï–ù–ù–ê–Ø –°–ï–ö–¶–ò–Ø -->
<div id="record-select" class="section">
    <div class="top-switch">
        <button id="modeCamera" class="active">üì∑ –ó–∞–ø–∏—Å—å —Å –∫–∞–º–µ—Ä—ã</button>
        <button id="modeUpload">üìÇ –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö</button>
    </div>

    <div class="settings-wrapper">
        <div class="settings">
            <h3>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h3>
            <label>
                Hand Detection Confidence:
                <input type="range" id="confidenceSlider" min="0.1" max="1.0" step="0.1" value="0.6">
                <span class="settings-value" id="confidenceValue">0.6</span>
            </label>
        </div>

        <div class="patient-info">
            <h3>–î–∞–Ω–Ω—ã–µ –ø–∞—Ü–∏–µ–Ω—Ç–∞</h3>
            <div class="patient-grid">
                <div>
                    <label for="patientId">–ù–æ–º–µ—Ä –ø–∞—Ü–∏–µ–Ω—Ç–∞:</label>
                    <input type="text" id="patientId" name="patientId" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 12345">
                </div>
                <div>
                    <label for="exercise">–£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ:</label>
                    <select id="exercise" name="exercise">
                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ</option>
                        <option value="FT">–ü–æ—Å—Ç—É–∫–∏–≤–∞–Ω–∏–µ –ø–∞–ª—å—Ü–∞–º–∏</option>
                        <option value="OC">–°–∂–∏–º–∞–Ω–∏–µ/—Ä–∞–∑–∂–∏–º–∞–Ω–∏–µ –∫—É–ª–∞–∫–∞</option>
                        <option value="PS">–ü—Ä–æ–Ω–∞—Ü–∏—è/—Å—É–ø–∏–Ω–∞—Ü–∏—è –∫–∏—Å—Ç–∏</option>
                    </select>
                </div>
                <div>
                    <label for="hand">–†—É–∫–∞:</label>
                    <select id="hand" name="hand">
                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ä—É–∫—É</option>
                        <option value="R">–ü—Ä–∞–≤–∞—è —Ä—É–∫–∞</option>
                        <option value="L">–õ–µ–≤–∞—è —Ä—É–∫–∞</option>
                    </select>
                </div>
            </div>
        </div>
    </div>

    <!--–ë–ª–æ–∫ –∫–∞–º–µ—Ä—ã -->
    <div id="cameraSection" class="mode-section">
        <h1>üëã –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –¥–≤–∏–∂–µ–Ω–∏–π —Ä—É–∫</h1>
        <div class="video-container">
            <div class="video-box">
                <video id="localVideo" autoplay muted playsinline class="hiddenVideo"></video>
            </div>
            <div class="video-box">
                <img id="processedVideo" alt="Processed Stream" />
            </div>
        </div>

        <div class="controls">
            <button id="startBtn">‚ñ∂ –ó–∞–ø—É—Å—Ç–∏—Ç—å –∫–∞–º–µ—Ä—É</button>
            <button id="stopBtn" style="display:none;">‚èπ –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–∞–º–µ—Ä—É</button>
            <button id="recordBtn">üî¥ –ù–∞—á–∞—Ç—å –∑–∞–ø–∏—Å—å</button>
        </div>
    </div>

    <!--–ë–ª–æ–∫ –∑–∞–≥—Ä—É–∑–∫–∏ -->
    <div id="uploadSection" class="mode-section" style="display:none;">
        <h2>–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏</h2>

        <input type="file" id="files" name="file" accept="video/*">
        <button id="uploadBtn">–ó–∞–≥—Ä—É–∑–∏—Ç—å</button>
    </div>
    <div class="controls">
        <button id="startProcessingBtn">–ù–∞—á–∞—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É</button>
    </div>
    <canvas id="signalCanvas" width="800" height="400"
        style="border:1px solid #ccc; display:none; margin: 20px auto;"></canvas>
    <canvas id="featureCanvas" width="800" height="400"
        style="border:1px solid #ccc; display:none; margin: 20px auto;"></canvas>
    <div id="featureLegend" style="display:none; margin-top: 10px; font-family: monospace;"></div>
</div>

<div id=" process" class="section">
    <h1>‚öôÔ∏è –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö</h1>
    <p>–ó–¥–µ—Å—å –º–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏.</p>
</div>

<div id="signals" class="section">
    <h1>üìà –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ —Å–∏–≥–Ω–∞–ª–æ–≤</h1>
    <p>–ó–¥–µ—Å—å –±—É–¥—É—Ç –≥—Ä–∞—Ñ–∏–∫–∏ —Å–∏–≥–Ω–∞–ª–æ–≤.</p>
</div>

<canvas id="debugCanvas" width="640" height="480"></canvas>
{% endblock %}

{% block scripts %}
<script src="/static/js/hand_tracking.js"></script>
{% endblock %}